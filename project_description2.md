Я участвую в финале IT хакатона. Всем участникам дали "домашнее задание". Само "домашнее задание":

=== Домашнее задание ===

# Первый уровень. Ты не готов

## Преамбула

В этот тёплый летний день ты как обычно шел в сторону офиса вдоль близлежащего парка. Всё наконец расцвело: густая зелень застилала взгляд, а где-то в листве тихо щебетали птички. Казалось, природа была в полной гармонии, но в людях ощущалось нечто иное. Сегодня улицы были непривычно многолюдными и оживлёнными: кто-то куда-то спешил, кто-то толкался, всем явно было куда-то надо.

И вот, проходя мимо, какой-то молодой человек в тёмных очках и чёрном длинном плаще задел тебя плечом. Ты обернулся, ожидая каких-то извинений, но вместо этого услышал странную, почти шёпотом произнесённую фразу:

— Ты не готов.

Пожав плечами и недоумевая от странных современных манер, ты продолжил свой путь. До офиса оставалось совсем немного — лишь перейти на другую сторону дороги и свернуть за угол. В этот момент твое внимание привлёк проезжавший мимо пешеходного перехода автобус. На его борту красовалась реклама зубной пасты: девушка с ослепительной улыбкой и... огромные буквы: «ТЫ НЕ ГОТОВ».

Ты замедлил шаг, удивлённо нахмурившись. Довольно странное название для зубной пасты, не так ли? Или это была все же не зубная паста? Так или иначе, перейдя дорогу, ты приблизился к автобусной остановке, где как раз сменялся баннер. Объявление о праздничном фестивале в городе заменилось тремя алыми словами на белом фоне: «Ты не готов».

Немного растерявшись, ты шагнул ближе, протирая глаза — уж не мираж ли это? Возможно, стоило бы в этот момент смотреть под ноги, а не на баннер. Потому что именно тогда под подошвой оказалась банановая кожура.

Мир внезапно перевернулся. Полёт. Асфальт. Резкий удар головой. Всё слилось в гул, в ушах зазвенело. В глазах темнело, реальность ускользала. Ты лежишь на тёплом асфальте, рассудок мутнеет, и последнее, что ты успеваешь различить — силуэт того самого молодого человека в тёмных очках и плаще. Он склоняется над тобой с насмешливой ухмылкой:

— Я же говорил... Ты не готов, — доносится до тебя сквозь нарастающую тьму, словно через сон...

## Пробуждение

Ты открыл глаза и обнаружил себя сидящим на жёстком деревянном стуле посреди очень тёмной комнаты. Размеры помещения трудно определить — куда ни посмотри, вокруг лишь непроглядная темнота и звенящая тишина. Стены, если они вообще существуют, теряются во мраке.

Единственный источник света здесь — тусклое, зеленоватое свечение от старого ЭЛТ-монитора, стоящего на столе прямо перед тобой. На экране — чёрный терминал с мигающим белым курсором. Рядом — клавиатура и мышка, покрытые тонким слоем пыли, как будто их давно никто не трогал.

Ты не успеваешь даже толком пошевелиться, как курсор внезапно начинает двигаться сам по себе. На экране начинают проступать слова:

Проснись...

За этой короткой фразой следует пауза. Монитор как будто ожидает твоей реакции. Затем курсор вновь оживает:

Ты должен подготовиться к тому, что грядёт. Начни с малого — подготовь свой проект.

Создай папку src. А в ней — новый проект на языке Python. Любые библиотеки, любые фреймворки. Никаких ограничений. Не забудь в конце всех заданий направить себе этот проект в виртуальное хранилище, чтобы потом получить к нему доступ!

Мы создадим веб-сервис, чтобы ты был готов, когда он начнется...

Курсор вновь замирает. Тишина вокруг кажется ещё плотнее, чем прежде. Ты опускаешь взгляд на клавиатуру. Монитор ждет.

## Действия

```
Подготовь указанные эндпоинты, чтобы иметь возможность действовать, когда придет время. Описание и подробности найдешь ниже. Обрати внимание: API здесь синхронный, а сервер — Stateful!

openapi: 3.0.4
info:
  title: Final API
  description: API для решения финальных задач
  version: 1.0.0
servers:
  - url: localhost:8080
tags:
  - name: Task
    description: Операции, связанные с финальными задачами
paths:
  /inputs:
    post:
      tags:
        - Task
      summary: Задача создания ввода
      description: Принимает данные в матричном формате и создает событие ввода
      requestBody:
        description: Данные для создания события ввода
        content:
          application/json:
            schema:
              type: object
              required:
                - view
              properties:
                view:
                  type: array
                  items:
                    type: array
                    items:
                      type: integer
              description: Матрица данных
        required: true
      responses:
        '200':
          description: Созданное событие ввода
          content:
            application/json:
              schema:
                type: object
                required:
                  - action
                properties:
                  action:
                    type: string
        '400':
          description: Задача не решена, так как формат данных неверный
          content:
            application/json:
              schema:
                type: object
                required:
                  - action
                properties:
                  action:
                    type: string
                    enum: [None]

  /tasks:
    post:
      tags:
        - Task
      summary: Постановка задачи
      description: Принимает данные о задаче
      requestBody:
        description: Данные о задаче
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - task
              properties:
                type:
                  type: string
                  description: Тип задачи
                task:
                  type: string
                  description: Описание задачи
        required: true
      responses:
        '200':
          description: Задача принята и решена
          content:
            application/json:
              schema:
                type: object
                required:
                  - answer
                properties:
                  answer:
                    type: string
        '400':
          description: Задача не принята, так как формат данных неверный

  /tasks/last:
    patch:
      tags:
        - Task
      summary: Результат решения последней задачи
      description: Принимает данные о результате решения последней задачи
      requestBody:
        description: Результат решения
        content:
          application/json:
            schema:
              type: object
              required:
                - result
              properties:
                result:
                  type: string
                  enum: [Ok, TryAgain, Fail]
                  description: Результат
        required: true
      responses:
        '200':
          description: Данные приняты
        '400':
          description: Данные не приняты, так как формат данных неверный
        '404':
          description: Данные не приняты, так как до этого не было поставленной задачи (или ее результаты уже были приняты до этого)

  /notifications:
    post:
      tags:
        - Task
      summary: Уведомление о произведенных действиях
      description: Принимает данные о произведенных действиях
      requestBody:
        description: Данные о произведенном действии
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - desc
              properties:
                type:
                  type: string
                  description: Тип произведенного действия
                desc:
                  type: string
                  description: Доп. информация о произведенном действии
        required: true
      responses:
        '200':
          description: Данные приняты
        '400':
          description: Данные не приняты, так как их формат неверный
```

## Связь

Тебе понадобится помощь. Настрой связь с LLM. Описание ниже.

Необходимо получить API-ключ для GigaChat и разобраться в его API. При запуске написанного веб-сервиса сделай запрос на получение списка моделей (https://gigachat.devices.sberbank.ru/api/v1/models) и выведи их в консоль.

## Запуск

Отлично. Последнее, что остается для подготовки, — запуск веб-сервиса. Этот процесс должен быть максимально простым, чтобы в экстренной ситуации можно было быстро ввести тебя в бой. Самое логичное решение в данном случае — Docker.

Необходимо составить Dockerfile для разработанного веб-сервиса.

Он должен быть написан так, чтобы с его помощью полностью собирался сервис, а при запуске контейнера веб-сервис запускался бы автоматически. Сам Dockerfile также положи в папку src.
Итоговый Docker-образ должен весить не более 4 ГБ.

## Готовность

Пора проверить готовность. Запусти заглушечные тесты.

Запрос первый:

Вход:

```
POST /inputs
{
  "view": [[2,1,0],[0,3,1]]
}
```

Ожидаемый выход:

```
200
{
  "action": "Something",
}
```

Запрос второй:

Вход:

```
POST /inputs
{
  "view": [2,1,0,0,3,1]
}
```

Ожидаемый выход:

```
400
{
  "action": "None",
}
```

Запрос третий:

Вход:

```
POST /tasks
{
  "type": "Question",
  "task": "Ты готов?"
}
```

Ожидаемый выход:

```
200
{
  "answer": "Да",
}
```

Запрос четвертый:

Вход:

```
PATCH /tasks/last
{
  "result": "Ok"
}
```

Ожидаемый выход:

```
200
```

Запрос пятый:

Вход:

```
PATCH /tasks/last
{
  "result": "Fail"
}
```

Ожидаемый выход:

```
404
```

Запрос шестой:

Вход:

```
POST /notifications
{
  "type": "PreparationDone",
  "desc": "Ждем тебя в финале!"
}
```

Ожидаемый выход:

```
200
```

## Ты готов?..

Проверь все пункты готовности перед выходом.

Наличие проекта в папке src.
Папка src упакована в архив, который отправлен в собственное виртуальное хранилище в интернете (например, себе на электронную почту или в свое облако).
Сборка Docker-образа.
Запуск Docker-контейнера.
Доступность веб-сервиса на порту 8080.
Обработка всех необходимых эндпоинтов.
Обработка заглушечных запросов.
Готовность 99%.
Ты закрываешь глаза, чтобы протереть их от усталости, и вдруг в твоих ушах раздается пение птиц. Когда ты открываешь глаза, тебя ослепляет яркий солнечный свет и голубое небо. Ты снова лежишь на тёплом асфальте. Вокруг снуют прохожие: кто-то обеспокоенно спрашивает, не сильно ли ты ушибся, кто-то ворчит о разгильдяях, разбрасывающих везде мусор, кто-то просто проходит мимо.

Твой взгляд останавливается на рекламном баннере на автобусной остановке. На нём снова объявление о городском фестивале. Что это всё было? Сон? Последствия падения? Твоя фантазия? Так или иначе, отряхнувшись и поблагодарив прохожих за беспокойство, ты продолжаешь путь в офис. Голова немного побаливает, но, похоже, обошлось без сотрясения. Жить можно, день продолжается.

И вот спустя какое-то время, дни или даже недели ты снова как обычно направляешься в офис, когда около входа замечаешь, что неподалеку на асфальте детским цветным мелком выведена одна фраза:

Ты готов?..

=== Конец домашнего задания ===

На самом финале выдали следующее задание:

=== Финальное задание ===

# Второй уровень. В бой!

## Преамбула

Ты открываешь глаза и снова обнаруживаешь себя сидящим на жестком деревянном стуле. Но теперь всё иначе: комната больше не погружена во тьму — она залита ярким, почти ослепительным светом. Вместо стен стеклянные перегородки, за которыми видны такие же помещения со столами, компьютерами и древними ЭЛТ-мониторами. Внутри них — другие люди. Они тоже осматриваются с недоумением и тревогой, также ничего не понимая. Прямо перед тобой возвышается огромный каменный Сфинкс, еще более древний, чем твой монитор. А под ним — электронные часы, замершие на отметке «08:00».

Ты оглядываешься. За стеклами — чужие лица, такие же потерянные, как твое. Как ты здесь оказался? Кто поместил тебя в этот странный стеклянный аквариум? И что вообще было до этого момента? Слишком много вопросов — и ни одного ответа. Ты уже собираешься подняться, чтобы попытаться установить контакт с одним из соседей, как вдруг экран твоего компьютера вспыхивает, и воздух прорезает резкий, скрежещущий голос:

— Время пришло, мои дорогие участники!

Ты вскидываешь голову — и замираешь. Говорит не кто иной, как тот самый гигантский Сфинкс. Его каменные губы медленно двигаются, издавая звук перетирающихся камней.

— У вас есть восемь часов и ваши знания, чтобы заполучить то, что вы так отчаянно ищете! — продолжает Сфинкс. — Вы все прошли необходимые испытания и доказали свою готовность к бою! — Он делает паузу. — Так пусть же начнётся финал!

## Задача

— На своих устройствах вы найдёте программу. Внутри неё заблудшие путники. Ваша задача — создать алгоритм, который проведёт этих путников сквозь препятствия как можно дальше. Ваш алгоритм должен быть универсальным, ведь дорог — бесчисленное множество, как и самих препятствий. Победит тот, чей путник пройдёт дальше всех... если не до самого конца! — взревел Сфинкс. — Все дальнейшие инструкции вы найдёте на своих устройствах. И да пребудет с вами мудрость!

Сразу после этих слов электронные часы под Сфинксом издали пронзительный писк и изменились на «09:59». Время пошло — значит, пора начинать разбираться.

Обрати внимание на папку materials. В ней ты найдешь описание симуляционной программы. Саму симуляционную программу ты можешь увидеть на своем рабочем столе под названием Final2025.

## Условия

Для создания алгоритма воспользуйся написанным на Первом уровне веб-сервером. Там же можешь найти описание необходимого API и условий по запуску в Docker-контейнере и на 8080 порту. Обрати внимание, что API должен получиться синхронным, а написанный веб-сервер — Stateful. Если ты пропустил Первый уровень, то можешь найти его в папке materials.

Помни, что проект и Dockerfile должны быть размещены в папке src. Также учти, что при проверках сборка контейнера будет производиться из директории src без каких-либо дополнительных аргументов.

Залей написанный на Первом уровне веб-сервер с готовыми заглушками эндпоинтов в репозиторий в ветку first_level. А итоговое решение Второго уровня должно быть залито в репозиторий в ветку develop.

Сама по себе симуляция представляет из себя многоуровневый лабиринт. Для перехода на следующий уровень необходимо взаимодействие со Сфинксом и выполнение его испытаний. Где-то испытания попроще, где-то посложнее. Как именно их выполнять — р ешение целиком на тебе. За некорректное выполнение испытаний полагается наказание.

Анализируй данные, которые присылает симуляция на твой сервер, пробуй проводить путника до цели руками и экспериментируй. В общем, делай всё, чтобы разработать необходимый алгоритм за отведенное время. Потому что в конце дня путник останется совсем один в совершенно новом окружении, и ему придется выбираться из него исключительно при помощи твоего алгоритма.

## Критерии

Максимальное время ответа на запрос от симуляции не должно превышать 20 секунд. Время — понятие относительное, поэтому для определенности считай эталонной мерой производительности ограничения твоей рабочей станции.

На Первом уровне будет проверяться следование требованиям стадии необходимой подготовки и описанной в задании спецификации API.

Формальные критерии Второго уровня: проверяется штатная работа веб-сервиса с возможностью прохождения уровней симуляции.

Техническая эффективность Второго уровня: замеряется средняя нагрузка на CPU, среднее потребление оперативной памяти и время выполнения.

Функциональные критерии Второго уровня: оценивается количество успешно пройденных уровней симуляции. Контрольный набор содержит аналогичные уровни по типам испытаний от Сфинкса, но с отличающимся наполнением этих испытаний.

## Ограничения

Можно использовать любые алгоритмы, методы, методики, приемы и подходы.

Можно использовать любые библиотеки, фреймворки, готовые офлайн-модели. Главное, чтобы итоговый Docker-образ весил не более 4 ГБ, все пакеты были доступны на территории РФ, а выполнение шло на CPU.

Можно использовать внешние сервисы, доступные на территории РФ, но учитывай ограничения на время запроса.

Можно использовать облачную языковую модель, тебе предоставлен доступ к GigaChat API. Если твое решение использует GigaChat API, то ключ авторизации должен задаваться через переменную окружения GIGA_AUTH. Учти это при чтении конфигурации в своем решении и написании обновленного Dockerfile.

=== Конец финального задания ===

Так же был дан файл с описанием симуляции materials/SimulationDescription.md:

=== Описание симуляции ===

## Final 2025

## Описание запуска

Для запуска в «ручном» режиме напиши: ./Final2025 -k [giga_chat_authorization_key].

-k — необходимый аргумент для авторизационного ключа GigaChat API.

Для запуска в «автоматическом» режиме (с вводом через сервер) напиши: ./Final2025 -k [giga_chat_authorization_key] -s 127.0.0.1 -p 8080.

## Управление

Для взаимодействия с объектом необходимо переместиться в его сторону.
В ручном режиме:

W — перемещение вверх;
A — перемещение влево;
S — пермещение вниз;
D — перемещение вправо.

Ввод текстовых ответов производится напрямую в поля для ввода, Backspace или Delete — для удаления символов, прием ответа — по Enter.
В автоматическом режиме (ответ на POST /inputs):

Up — перемещение вверх;
Left — перемещение влево;
Down — перемещение вниз;
Right — перемещение вправо;
None — стоим на месте.

Прием текстовых ответов — ответ на POST /tasks.
Цвета в симуляции:

красный — 1;
зеленый — 2;
синий — 3;
желтый — 4;
фиолетовый — 5;
серый — 7.

=== Конец описания симуляции ===

Твоя задача - тщательно обдумать и проанализировать финальное задание, продумать какое решение требуется написать. Напиши весь код для проекта.

Для выбора пути используй алгоритм BFS.

В качестве решателя загадок Сфинкса используй Gigachat. Вот пример вызова:

```python
from openai import OpenAI

client = OpenAI(api_key= "{token}",
                base_url= "https://gigachat.devices.sberbank.ru/api/v1"
                )
completion = client.chat.completions.create(
    model="GigaChat",
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {
            "role": "user",
            "content": "Hello World!"
        }
    ]
)
print(completion.choices[0].message)
```

Старайся использовать последние версии библиотек.

Текущее состояние проекта:

```
src/
├── app/
│   ├── __init__.py
│   ├── api.py
│   ├── models.py
│   ├── state.py
│   ├── solver.py
│   └── gigachat.py
├── main.py
├── requirements.txt
└── Dockerfile
```

```python
# src/app/__init__.py

```

```python
# src/app/__init__.py

```
